
import requests
import sys

def check_headers(url):
    print(f"[*] Scanning headers for {url}...")
    try:
        response = requests.get(url)
        headers = response.headers
        
        security_headers = [
            'X-Frame-Options',
            'X-XSS-Protection',
            'Content-Security-Policy',
            'Strict-Transport-Security'
        ]
        
        missing_headers = []
        for header in security_headers:
            if header not in headers:
                missing_headers.append(header)
                print(f"[-] Missing Security Header: {header}")
            else:
                print(f"[+] Found: {header}")
        
        if not missing_headers:
            print("[*] Good job! Basic security headers are present.")
        else:
            print(f"[!] Alert: {len(missing_headers)} security headers missing.")
            
    except Exception as e:
        print(f"[!] Error connecting to target: {e}")

def main():
    print("--- Python Web Vulnerability Scanner ---")
    if len(sys.argv) < 2:
        print("Usage: python scanner.py <url>")
        print("Example: python scanner.py http://example.com")
        return
        
    target_url = sys.argv[1]
    check_headers(target_url)

if __name__ == "__main__":
    main()
